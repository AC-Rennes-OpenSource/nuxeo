<?xml version="1.0"?>

<component name="org.nuxeo.segment.io.SegmentIOComponent" version="1.0">

  <implementation class="org.nuxeo.segment.io.SegmentIOComponent" />

  <service>
      <provide interface="org.nuxeo.segment.io.SegmentIO" />
  </service>

  <extension-point name="config">
    <documentation>
      Configure segment.io settings : mainly the Write Key that is used to send info to the segment.io backend.
      @author Thierry Delprat (td@nuxeo.com)
    </documentation>
    <object
      class="org.nuxeo.segment.io.SegmentIOConfig" />
  </extension-point>

  <extension-point name="mapper">
    <documentation>
      Define mapping XXX

      @author Thierry Delprat (td@nuxeo.com)
    </documentation>
    <object
      class="org.nuxeo.segment.io.SegmentIOMapper" />
  </extension-point>

  <extension-point name="providers">
    <documentation>
      Allows to configure segment.io providers configuration.

      See https://segment.io/docs/libraries/java/#selecting-providers

      @author Thierry Delprat (td@nuxeo.com)
    </documentation>
    <object
      class="org.nuxeo.segment.io.SegmentIOProviders" />
  </extension-point>

  <extension-point name="filters">
    <documentation>
      Allows to filter out events associated with particular users

      @author Thierry Delprat (td@nuxeo.com)
    </documentation>
    <object
      class="org.nuxeo.segment.io.SegmentIOUserFilter" />
  </extension-point>

  <!--  add default configuration for Marketo (should move to connect) -->
  <extension target="org.nuxeo.segment.io.SegmentIOComponent"
    point="providers">
    <providersConfig>
      <providers>
        <provider name="Marketo">true</provider>
      </providers>
    </providersConfig>
  </extension>

  <!--  add default configuration for Connect (should move to connect) -->
  <extension target="org.nuxeo.segment.io.SegmentIOComponent"
    point="filters">
    <userFilter>
      <enableAnonymous>false</enableAnonymous>
      <blackListedUser>RemoteConnectInstance</blackListedUser>
    </userFilter>
  </extension>


</component>
