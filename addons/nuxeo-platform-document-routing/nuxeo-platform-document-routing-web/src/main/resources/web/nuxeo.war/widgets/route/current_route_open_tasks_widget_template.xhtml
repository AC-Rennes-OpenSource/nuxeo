<c:if test="true"
  xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:nxl="http://nuxeo.org/nxforms/layout"
  xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
  xmlns:fn="http://java.sun.com/jsp/jstl/functions">

  <nxu:set var="tasks" value="#{routingActions.getCurrentRouteAllTasks()}"
    cache="true">

    <c:if test="#{!empty tasks}">
      <h3 class="summaryTitle">
        <h:outputText value="#{messages['label.document.routing.open.tasks']}" />
      </h3>

      <c:forEach var="task" items="#{tasks}" varStatus="status">
        <div>
          <h:outputFormat styleClass="boldLabel" value="#{messages['label.route.task.type']} ">
            <f:param value="#{messages[task.name]}" />
          </h:outputFormat>
          <h:outputText value="#{messages['label.route.task.assigned.to']} " />
          <c:forEach var="actor" items="#{task.actors}">
            <c:choose>
              <c:when test="#{fn:startsWith(actor,'group:')}">
                <nxu:set var="user" value="#{fn:split(actor, ':')[1]}">
                <span class="tag group creator">
                  <a href="#{baseURL}group/#{group}">
                    #{group}
                  </a>
                </span>
                </nxu:set>
              </c:when>
              <c:when test="#{fn:startsWith(actor, 'user:')}">
                <nxu:set var="user" value="#{fn:split(actor, ':')[1]}">
                <span class="tag user creator">
                  <a href="#{baseURL}user/#{user}">
                    #{nxu:userFullName(user)}
                  </a>
                </span>
                </nxu:set>
              </c:when>
              <c:otherwise>
                <span class="tag user creator">
                  #{actor}
                </span>
              </c:otherwise>
            </c:choose>
          </c:forEach>
          <div class="dueDate warningLabel">
            <h:outputText value=" #{messages['label.route.task.due.date']} " />
            <h:outputText value="#{task.dueDate}" />
          </div>
          <div class="directive quote">
            <h:outputText value="#{messages[task.directive]}" />
          </div>
        </div>
      </c:forEach>

    </c:if>

  </nxu:set>

</c:if>
