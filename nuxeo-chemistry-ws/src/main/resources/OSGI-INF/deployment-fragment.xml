<?xml version="1.0"?>
<fragment>
  <extension target="application#MODULE">
    <module>
      <java>${bundle.fileName}</java>
    </module>
  </extension>

  <extension target="web#AUTH-FILTER">
    <filter>
      <filter-name>WSSUsernameTokenSSOFilter</filter-name>
      <filter-class>org.nuxeo.ecm.core.chemistry.ws.WSSUsernameTokenSSOFilter</filter-class>
    </filter>

    <!-- should be in target="web#FILTER-MAPPING" but needs to be
         before standard NuxeoAuthenticationFilter filter-mapping -->
    <filter-mapping>
      <filter-name>WSSUsernameTokenSSOFilter</filter-name>
      <url-pattern>/webservices/cmis/*</url-pattern>
    </filter-mapping>
  </extension>

  <extension target="jaxws#ENDPOINT">
    <endpoint name="RepositoryService"
      implementation="org.nuxeo.ecm.core.chemistry.ws.RepositoryServicePortImpl"
      url-pattern="/webservices/cmis/RepositoryService" />
  </extension>
  <extension target="jaxws#ENDPOINT">
    <endpoint name="DiscoveryService"
      implementation="org.nuxeo.ecm.core.chemistry.ws.DiscoveryServicePortImpl"
      url-pattern="/webservices/cmis/DiscoveryService" />
  </extension>
</fragment>
