<assembly>

  <zipEntrySet id="base-template">
    <artifact>
      org.nuxeo.ecm.distribution:nuxeo-distribution-server:${nuxeo.distribution.version}:zip
    </artifact>
    <!-- to avoid duplicate libraries -->
    <excludes>
      <exclude>lib/javassist-3.6.jar</exclude>
      <exclude>lib/servlet-api-2.4.jar</exclude>
    </excludes>
  </zipEntrySet>

  <fileSet id="template">
    <directory>src/main/resources</directory>
  </fileSet>

  <artifactSet id="bundles">
    <import>**</import>
    <includeDependencies>true</includeDependencies>
    <includes>
      <artifact group="org.nuxeo*" />
      <!-- add here nuxeo-addons -->
    </includes>
    <excludes>
      <artifact group="!org.nuxeo*" />
      <artifact group="org.nuxeo.common" />

      <artifact name="nuxeo-core-storage-sql-ra" />
      <artifact name="nuxeo-apt-extensions" />
      <artifact name="nuxeo-webengine-apt" />

      <!-- exclude webservices -->
      <artifact name="nuxeo-platform-ws" />

      <!-- exclude facades -->
      <artifact name="nuxeo-platform-audit-facade" />
      <artifact name="nuxeo-core-facade" />
      <artifact name="nuxeo-platform-directory-facade" />
      <artifact name="nuxeo-platform-filemanager-facade" />
      <artifact name="nuxeo-platform-io-facade" />
      <artifact name="nuxeo-platform-jbpm-facade" />
      <artifact name="nuxeo-platform-mimetype-facade" />
      <artifact name="nuxeo-platform-notification-facade" />
      <artifact name="nuxeo-platform-placeful-facade" />
      <artifact name="nuxeo-platform-relations-facade" />
      <artifact name="nuxeo-platform-search-facade" />
      <artifact name="nuxeo-platform-types-facade" />
      <artifact name="nuxeo-platform-url-facade" />
      <artifact name="nuxeo-platform-usermanager-facade" />
      <artifact name="nuxeo-platform-tag-facade" />
      <artifact name="nuxeo-platform-annotations-facade" />
      <artifact name="nuxeo-platform-imaging-facade" />
      <artifact name="nuxeo-platform-userworkspace-facade" />
      <artifact name="nuxeo-dam-facade" />

      <!-- exclude jboss dependencies -->
      <artifact name="nuxeo-runtime-jboss-adapter" />
      <artifact name="nuxeo-platform-auth-web-jboss" />
      <artifact name="nuxeo-platform-login-jboss" />

      <!-- exclude dependencies not needed by DAM -->
      <artifact name="nuxeo-platform-webapp" />
      <artifact name="nuxeo-platform-webapp-core" />

      <artifact name="nuxeo-platform-imaging-web" />
      <artifact name="nuxeo-platform-virtualnavigation-web" />
      <artifact name="nuxeo-platform-forum*" />
      <artifact name="nuxeo-platform-syndication" />
      <artifact name="nuxeo-platform-publish*" />
      <artifact name="nuxeo-platform-comment-web" />
      <artifact name="nuxeo-platform-workflow*" />

      <artifact name="nuxeo-platform-lang" />

      <artifact name="nuxeo-platform-ear" />
      <artifact name="nuxeo-dam-ear" />
      <artifact name="nuxeo-apt-extensions" />

      <artifact name="nuxeo-webengine-admin" />
      <artifact name="nuxeo-webengine-sites" />
      <artifact name="nuxeo-webengine-ui" />
    </excludes>
  </artifactSet>

  <artifactSet id="third-party-libs">
    <artifacts>
      <!-- Synchro Added packages -->
      <artifact group="javax.activation" name="activation" />
      <artifact group="apache-httpclient" name="commons-httpclient" />
      <artifact group="commons-codec" name="commons-codec" />
      <artifact group="metro.webservices" name="webservices-api" />
      <artifact group="metro.webservices" name="webservices-rt" />
      <artifact group="metro.webservices" name="webservices-tools" />
      <!-- End Synchro Added packages -->

      <artifact group="javax.servlet" name="servlet-api" />
      <artifact group="org.mortbay.jetty" name="jetty" />
      <artifact group="org.mortbay.jetty" name="jetty-plus" />
      <artifact group="org.mortbay.jetty" name="jetty-naming" />
      <artifact group="org.mortbay.jetty" name="jetty-annotations" />
      <artifact group="org.mortbay.jetty" name="jetty-util" />
      <artifact group="jotm" name="jotm" />
      <artifact group="javax.ejb" name="ejb-api" />
      <artifact group="javax.transaction" name="jta" />

      <artifact group="org.apache.ant" name="ant" />
      <artifact group="bsh" name="bsh" />
      <artifact group="commons-el" name="commons-el" />
      <artifact group="commons-digester" name="commons-digester" />
      <artifact group="org.jboss.el" name="jboss-el" />

      <artifact group="org.jboss.seam" name="jboss-seam" />
      <artifact group="org.jboss.seam" name="jboss-seam-debug" />
      <artifact group="org.jboss.seam" name="jboss-seam-mail" />
      <artifact group="org.jboss.seam" name="jboss-seam-ui" />
      <artifact group="org.jboss.seam" name="jboss-seam-remoting" />

      <artifact group="org.jbpm.jbpm3" name="jbpm-jpdl" />

      <artifact group="org.openoffice" name="ridl" />
      <artifact group="org.openoffice" name="juh" />
      <artifact group="org.openoffice" name="unoil" />
      <artifact group="org.openoffice" name="jurt" />
      <artifact group="com.artofsolving" name="jodconverter" />
      <artifact group="com.thoughtworks.xstream" name="xstream" />
      <artifact group="pdfbox" name="pdfbox" />
      <artifact group="org.fontbox" name="fontbox" />

      <artifact group="org.richfaces.framework" name="richfaces-api" />
      <artifact group="org.richfaces.framework" name="richfaces-impl" />
      <artifact group="org.richfaces.ui" name="richfaces-ui" />
      <artifact group="org.richfaces.framework" name="richfaces-api" />
      <artifact group="javax.script" name="script-api" />
      <artifact group="org.apache.lucene" name="lucene-analyzers" />

      <artifact group="com.sun.facelets" name="jsf-facelets" />
      <artifact group="javax.faces" name="jsf-api" />
      <artifact group="javax.faces" name="jsf-impl" />

      <artifact group="org.mortbay.jetty" name="jsp-api-2.1" />
      <artifact group="org.mortbay.jetty" name="jsp-2.1" />

      <artifact group="jboss" name="javassist" />

      <artifact group="com.h2database" name="h2" />

      <artifact group="org.eclipse.jdt" name="core" />

      <artifact group="com.sun.xml" name="relaxngDatatype" />
      <artifact group="com.sun.xml" name="xsom" />
      <artifact group="cup" name="java-cup" />
      <artifact group="joda-time" name="joda-time" />
      <artifact group="org.wikimodel" name="wem" />

      <artifact group="com.hp.hpl.jena" name="jena" />
      <artifact group="com.hp.hpl.jena" name="arq" />
      <artifact group="com.hp.hpl.jena" name="iri" />
      <artifact group="com.ibm.icu" name="icu4j" />

      <artifact group="rome" name="rome" />
      <artifact group="jdom" name="jdom" />

      <artifact group="net.sf.opencsv" name="opencsv" />
      <artifact group="org.codehaus.plexus" name="plexus-utils" />


      <artifact group="jmimemagic" name="jmimemagic" />
      <artifact group="org.apache.poi" name="ooxml-schemas" />
      <artifact group="org.apache.poi" name="poi" />
      <artifact group="org.apache.poi" name="poi-ooxml" />
      <artifact group="org.apache.poi" name="poi-scratchpad" />
      <artifact group="org.apache" name="xmlbeans" />
      <artifact group="oro" name="oro" />
      <artifact group="opensymphony" name="quartz-all" />

      <artifact group="net.sf.ehcache" name="ehcache" />
      <artifact group="com.google.gwt" name="gwt-servlet" />
      <artifact group="backport-util-concurrent" name="backport-util-concurrent" />

      <!-- Nuxeo DAM libs -->
      <artifact group="de.schlichtherle.io" name="truezip"/>
    </artifacts>
  </artifactSet>

  <assemble>
    <set>base-template</set>
    <set>template</set>
    <outputFile>/</outputFile>
  </assemble>

  <assemble>
    <set>third-party-libs</set>
    <outputFile>lib</outputFile>
  </assemble>

  <assemble>
    <set>bundles</set>
    <outputFile>bundles</outputFile>
  </assemble>

  <assemble>
    <delete>true</delete>
    <outputFile>config</outputFile>
    <file>login-anonymous-config.xml</file>
  </assemble>

  <assemble>
    <delete>true</delete>
    <outputFile>lib</outputFile>
    <file>el-api-unknown.jar</file>
    <file>el-ri-unknown.jar</file>
  </assemble>

  <!-- Remove unused files for DAM -->
  <assemble>
    <delete>true</delete>
    <outputFile>/</outputFile>
    <file>examples</file>
    <file>extras</file>
    <file>scripts</file>
  </assemble>

  <assemble>
    <delete>true</delete>
    <outputFile>bundles</outputFile>
    <file>nuxeo-webengine-admin-${nuxeo.webengine.version}.jar</file>
    <file>nuxeo-webengine-ui-${nuxeo.webengine.version}.jar</file>
    <file>nuxeo-webengine-sites-${nuxeo.webengine.version}.jar</file>
    <file>nuxeo-platform-comment-web-${nuxeo.features.version}.jar</file>
  </assemble>

</assembly>
