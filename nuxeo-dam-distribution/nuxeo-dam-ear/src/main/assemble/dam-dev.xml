<assembly>

  <!-- RESOURCES -->
  <assemble>
    <set>resources</set>
    <outputFile>/</outputFile>
  </assemble>
  <zipEntrySet id="resources">
    <artifact>
      org.nuxeo.ecm.platform:nuxeo-platform-ear:${nuxeo.features.version}:zip:resources-mono
    </artifact>
  </zipEntrySet>

  <!-- ARTIFACTS -->
  <assemble>
    <outputFile>/</outputFile>
    <set>root-artifacts</set>
  </assemble>
  <artifactSet id="root-artifacts">
    <import>**</import>
    <includes>
      <artifact name="nuxeo-dam-webapp" />
      <artifact name="nuxeo-dam-webapp-core" />
    </includes>
  </artifactSet>

  <assemble>
    <outputFile>system</outputFile>
    <set>system</set>
  </assemble>
  <artifactSet id="system">
    <import>**</import>
    <includeDependencies>true</includeDependencies>
    <includes>
      <artifact group="org.nuxeo.*" category="runtime,jboss4" includeDependsOnCategory="false" />
      <artifact group="org.nuxeo.*" category="core,search,web" />
      <artifact name="nuxeo-platform-imaging*" />
      <artifact name="nuxeo-platform-video*" />
      <artifact name="nuxeo-platform-audio*" />
      <artifact name="nuxeo-chemistry*" />
      <artifact name="nuxeo-webengine*"/>
    </includes>
    <excludes>
      <artifact group="!org.nuxeo*" />
      <artifact group="org.nuxeo.common" />
      <artifact name="nuxeo-runtime-jboss-extensions" />

      <artifact name="nuxeo-platform-webapp" />
      <artifact name="nuxeo-platform-webapp-core" />

      <artifact name="nuxeo-platform-imaging-dm" />
      <artifact name="nuxeo-platform-virtualnavigation-web" />
      <artifact name="nuxeo-platform-forum*" />
      <artifact name="nuxeo-platform-syndication" />
      <artifact name="nuxeo-platform-publish*" />
      <artifact name="nuxeo-platform-comment-web" />
      <artifact name="nuxeo-platform-workflow*" />

      <artifact name="nuxeo-platform-audit-facade" />
      <artifact name="nuxeo-platform-placeful-facade" />
      <artifact name="nuxeo-platform-ear" />
      <artifact name="nuxeo-apt-extensions" />

      <artifact name="nuxeo-platform-lang" />

      <artifact name="nuxeo-dam-webapp" />
      <artifact name="nuxeo-dam-webapp-core" />
    </excludes>
  </artifactSet>

  <assemble>
    <outputFile>system</outputFile>
    <unpack>true</unpack>
    <unpackInNewDirectory>true</unpackInNewDirectory>
    <set>nuxeo-platform-unpacked</set>
  </assemble>
  <artifactSet id="nuxeo-platform-unpacked">
    <import>**</import>
    <includes>
      <artifact name="nuxeo-platform-audit-facade" />
      <artifact name="nuxeo-platform-placeful-facade" />
    </includes>
  </artifactSet>

  <!-- third party libraries embedded in the ear -->
  <assemble>
    <outputFile>lib</outputFile>
    <set>nuxeo-fixed-libs</set>
  </assemble>
  <artifactSet id="nuxeo-fixed-libs">
    <artifacts>
      <artifact group="org.freemarker" name="freemarker" />
      <artifact group="org.osgi" name="osgi-core" />
      <artifact group="commons-collections" name="commons-collections" />
      <artifact group="commons-io" name="commons-io" />
      <artifact group="commons-lang" name="commons-lang" />
      <artifact group="commons-fileupload" name="commons-fileupload" />
      <artifact group="net.sourceforge.cssparser" name="cssparser" />
      <artifact group="org.w3c" name="sac" />
      <artifact group="net.sf.ehcache" name="ehcache" />
      <artifact group="net.sf.ezmorph" name="ezmorph" />
      <artifact group="jboss" name="jboss-cache-jdk50" />
      <artifact group="org.jboss.seam" name="jboss-seam" />
      <artifact group="org.jboss.seam" name="jboss-seam-remoting" />
      <artifact group="org.jboss.seam" name="jboss-seam-ui" />
      <artifact group="org.jboss.seam" name="jboss-seam-mail" />
      <artifact group="org.jboss.seam" name="jboss-seam-debug" />
      <artifact group="javax.el" name="el-ri" />
      <artifact group="org.jboss.el" name="jboss-el" />
      <artifact group="org.jbpm.jbpm3" name="jbpm-jpdl" />
      <artifact group="jboss" name="jgroups" />
      <artifact group="org.restlet" name="org.restlet" />
      <artifact group="org.wikimodel" name="wem" />
      <artifact group="jmimemagic" name="jmimemagic" />
      <artifact group="rome" name="rome" />
      <artifact group="commons-jexl" name="commons-jexl" />
      <artifact group="com.hp.hpl.jena" name="arq" />
      <artifact group="com.noelios.restlet" name="com.noelios.restlet" />
      <artifact group="com.noelios.restlet" name="com.noelios.restlet.ext.servlet" />
      <artifact group="com.ibm.icu" name="icu4j" />
      <artifact group="com.hp.hpl.jena" name="iri" />
      <artifact group="cup" name="java-cup" />
      <artifact group="jdom" name="jdom" />
      <artifact group="com.hp.hpl.jena" name="jena" />
      <artifact group="joda-time" name="joda-time" />
      <artifact group="org.restlet" name="org.restlet.ext.fileupload" />
      <artifact group="oro" name="oro" />
      <artifact group="org.apache.poi" name="poi" />
      <artifact group="org.apache.poi" name="poi-scratchpad" />
      <artifact group="org.apache.poi" name="poi-ooxml" />
      <artifact group="com.sun.xml" name="relaxngDatatype" />
      <artifact group="com.sun.xml" name="xsom" />
      <!--
        version is needed because of assembly plugin don't manage
        classifier here
      -->
      <artifact group="net.sf.json-lib" name="json-lib" classifier="jdk15" version="2.2.1" />
      <artifact group="org.apache.lucene" name="lucene-core" />
      <artifact group="net.sf.opencsv" name="opencsv" />
      <artifact group="org.codehaus.plexus" name="plexus-utils" />
      <artifact group="org.slf4j" name="slf4j-api" />
      <artifact group="org.slf4j" name="slf4j-log4j12" />
      <artifact group="org.richfaces.framework" name="richfaces-api" />
      <artifact group="org.richfaces.framework" name="richfaces-impl" />
      <artifact group="org.richfaces.ui" name="richfaces-ui" />
      <artifact group="org.apache.directory.server" name="apacheds-protocol-shared" />
      <artifact group="org.apache.directory.shared" name="shared-ldap" />
      <artifact group="com.sun.facelets" name="jsf-facelets" />
      <artifact group="org.nuxeo.ecm.platform" name="nuxeo-jbossws-wrapper" />
      <!-- Nuxeo-WebEngine fixed libs -->
      <artifact group="org.codehaus.groovy" name="groovy-all" />
      <artifact group="com.sun.jersey" name="jersey-core" />
      <artifact group="com.sun.jersey" name="jersey-server" />
      <artifact group="javax.ws.rs" name="jsr311-api" />
      <artifact group="javax.script" name="script-api" />
      <!-- JOD / OOo libs and other converters deps-->
      <artifact group="com.artofsolving" name="jodconverter" />
      <artifact group="org.openoffice" name="ridl" />
      <artifact group="org.openoffice" name="juh" />
      <artifact group="org.openoffice" name="unoil" />
      <artifact group="org.openoffice" name="jurt" />
      <artifact group="com.thoughtworks.xstream" name="xstream" />
      <artifact group="pdfbox" name="pdfbox" />
      <artifact group="org.fontbox" name="fontbox" />
      <artifact group="org.jempbox" name="jempbox" />
      <artifact group="com.google.gwt" name="gwt-servlet" />
      <artifact group="de.schlichtherle.io" name="truezip" />

      <!-- CMIS libs -->
      <artifact group="org.apache.chemistry" name="chemistry-api" />
      <artifact group="org.apache.chemistry" name="chemistry-atompub" />
      <artifact group="org.apache.chemistry" name="chemistry-atompub-server" />
      <artifact group="org.apache.chemistry" name="chemistry-commons" />
      <artifact group="org.apache.chemistry" name="chemistry-ws" />

      <artifact group="org.apache.abdera" name="abdera-core" />
      <artifact group="org.apache.abdera" name="abdera-i18n" />
      <artifact group="org.apache.abdera" name="abdera-parser" />
      <artifact group="org.apache.abdera" name="abdera-server" />

      <artifact group="org.apache.ws.commons.axiom" name="axiom-api" />
      <artifact group="org.apache.ws.commons.axiom" name="axiom-impl" />
      <artifact group="org.antlr" name="antlr-runtime" />

    </artifacts>
  </artifactSet>

  <assemble>
    <outputFile>/</outputFile>
    <set>dam-common-resources</set>
  </assemble>
  <fileSet id="dam-common-resources">
    <directory>src/main/resources_dam_common
    </directory>
  </fileSet>

  <assemble>
    <outputFile>/</outputFile>
    <set>dam-dev-resources</set>
  </assemble>
  <fileSet id="dam-dev-resources">
    <directory>src/main/resources_dam_dev
    </directory>
  </fileSet>

  <assemble>
    <delete>true</delete>
    <outputFile>config</outputFile>
    <file>nxrelations-default-jena-bundle.xml</file>
    <file>nxmail-scheduler-config.xml</file>
  </assemble>

</assembly>
