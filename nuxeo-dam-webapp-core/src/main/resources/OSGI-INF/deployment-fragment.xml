<?xml version="1.0"?>
<fragment>

  <extension target="application#MODULE">
    <module>
      <ejb>${bundle.fileName}</ejb>
    </module>

    <module>
      <web>
        <web-uri>nuxeo.war</web-uri>
        <context-root>/nuxeo</context-root>
      </web>
    </module>
  </extension>

  <extension target="web#FILTER-MAPPING">
    <!-- Seam Context Filter is declared in org.nuxeo.ecm.platform.ui.web
      deployment fragment -->
    <filter-mapping>
      <filter-name>Seam Context Filter</filter-name>
      <url-pattern>/DocumentManagerWS</url-pattern>
    </filter-mapping>
  </extension>

  <extension target="faces-config#APPLICATION">
    <locale-config>
      <default-locale>en</default-locale>
      <supported-locale>en_GB</supported-locale>
      <supported-locale>en_US</supported-locale>
      <supported-locale>fr</supported-locale>
      <supported-locale>de</supported-locale>
      <supported-locale>es</supported-locale>
      <supported-locale>it</supported-locale>
      <supported-locale>ar</supported-locale>
      <supported-locale>ru</supported-locale>
      <supported-locale>ja</supported-locale>
      <supported-locale>vn</supported-locale>
    </locale-config>

    <message-bundle>messages</message-bundle>
  </extension>

  <extension target="faces-config#NAVIGATION">


    <navigation-case>
      <from-outcome>view_documents</from-outcome>
      <to-view-id>/view_documents.xhtml</to-view-id>
      <redirect />
    </navigation-case>

  <navigation-rule>
    <from-view-id>/incl/new_import_set_error.xhtml</from-view-id>
    <navigation-case>
         <from-outcome>next</from-outcome>
         <to-view-id>/incl/new_import_set.xhtml</to-view-id>
    </navigation-case>
  </navigation-rule>

  <navigation-rule>
    <from-view-id>/incl/new_import_set.xhtml</from-view-id>
    <navigation-case>
       <from-outcome>next</from-outcome>
       <to-view-id>/incl/new_import_set.xhtml</to-view-id>
    </navigation-case>
  </navigation-rule>

  </extension>

  <extension target="pages#PAGES">

    <!-- Post login and 'home' view handler -->
    <page view-id="/nxstartup.xhtml"
      action="#{startupHelper.initDomainAndFindStartupPage('Default domain', 'view')}"/>

  </extension>

</fragment>

