<?xml version="1.0" encoding="UTF-8"?>
<component name="org.nuxeo.dam.imaging">

  <extension
      target="org.nuxeo.ecm.platform.url.service.DocumentViewCodecService"
      point="codecs">
    <documentViewCodec name="downloadPicture" enabled="true"
                       prefix="nxpicsfile"
                       class="org.nuxeo.ecm.platform.url.codec.DocumentFileCodec"/>
  </extension>

  <extension
      target="org.nuxeo.ecm.platform.ui.web.auth.service.PluggableAuthenticationService"
      point="startURL">
    <startURLPattern>
      <patterns>
        <pattern>nxpicsfile/</pattern>
      </patterns>
    </startURLPattern>
  </extension>

  <extension target="org.nuxeo.ecm.platform.ui.web.rest.URLService"
             point="urlpatterns">
    <urlPattern name="downloadPicture" enabled="true">
      <defaultURLPolicy>false</defaultURLPolicy>
      <needBaseURL>true</needBaseURL>
      <needRedirectFilter>false</needRedirectFilter>
      <needFilterPreprocessing>true</needFilterPreprocessing>
      <codecName>downloadPicture</codecName>
      <actionBinding>#{pictureActions.downloadPicture}</actionBinding>
      <documentViewBinding>
        #{restHelper.documentView}
      </documentViewBinding>
      <newDocumentViewBinding>
        #{restHelper.newDocumentView}
      </newDocumentViewBinding>
    </urlPattern>
  </extension>

</component>