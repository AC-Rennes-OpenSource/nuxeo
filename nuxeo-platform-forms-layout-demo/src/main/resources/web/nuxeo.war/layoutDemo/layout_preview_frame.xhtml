<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:nxl="http://nuxeo.org/nxforms/layout"
  xmlns:nxu="http://nuxeo.org/nxweb/util">
<ui:remove>
  Generates a preview given a layout definition in request parameters.
</ui:remove>

  <f:view contentType="text/html" />
  <h:head id="pageHead">
    <title>
      <h:outputText
        value="#{messages['label.layoutDemo.shortTitle']} - #{messages['label.layoutDemo.widgetPreview.title']}"/>
    </title>

    <ui:decorate template="/incl/page_head.xhtml">
      <ui:param name="name" value="layoutDemo/default" />
    </ui:decorate>

  </h:head>

  <h:body>

    <ui:include src="/incl/includes.xhtml" />

    <h:form id="previewLayoutForm">
      <nxu:set var="jsonLayoutDef" value="#{request.getParameter('layoutDefinition')}">
      <nxu:set var="layoutDef" value="#{layoutPreviewActions.getDecodedLayoutDefinition(jsonLayoutDef)}">
      <nxu:set var="layoutMode" value="#{request.getParameter('layoutMode')}">
      <nxu:set var="layoutTemplate" value="#{request.getParameter('layoutTemplate')}">
        <nxl:layout
          definition="#{layoutDef}"
          value="#{layoutPreviewDocument}"
          mode="#{layoutMode}"
          template="#{layoutTemplate}" />
      </nxu:set>
      </nxu:set>
      </nxu:set>
      </nxu:set>
    </h:form>

  </h:body>
</html>