<div xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:nxl="http://nuxeo.org/nxforms/layout">

  <h3><h:outputText value="${messages['label.importset.title.select.folder']}" /></h3>

  <a4j:region>
  <a4j:outputPanel id="importSetPanel">
  <rich:fileUpload id="fileUploadForm" fileUploadListener="#{importActions.uploadListener}"
    maxFilesQuantity="1" immediateUpload="true"
    onuploadcomplete="fileUploadComplete();"
    ajaxSingle="true"
    addControlLabel="${messages['label.action.importset.creation.select.file']}"
    clearAllControlLabel="${messages['label.action.importset.creation.clear.all']}"
    clearControlLabel="${messages['label.action.importset.creation.clear']}"
    stopEntryControlLabel="${messages['label.action.importset.creation.stop.upload']}"
    uploadControlLabel="${messages['label.action.importset.creation.start.upload']}"
    doneLabel="${messages['label.action.importset.creation.done']}"
    transferErrorLabel="${messages[label.fileupload.message.error]}"
    listWidth="465px">
    <f:facet name="label">
      <h:outputText value="{_KB}KB from {KB}KB uploaded --- {mm}:{ss}" />
    </f:facet>
  </rich:fileUpload>


  <h3><h:outputText value="${messages['label.importset.title.select.metadata']}" /></h3>

  <a4j:form id="importset_form"
    ajaxSingle="true" enctype="multipart/form-data">
    <nxl:documentLayout mode="create" value="#{importActions.newImportSet}" />

    <table class="dataInput">
      <tbody>
        <tr>
          <td class="labelColumn">
            <h:outputText value="#{messages['label.widget.importfolder']}" />
          </td>
          <td class="fieldColumn">
            <h:selectOneMenu value="#{importActions.importFolder}">
              <f:selectItems value="#{importActions.importFolders}" />
            </h:selectOneMenu>
          </td>
        </tr>
      </tbody>
    </table>

    <p class="buttonsGadget">

      <a4j:commandButton id="importSetFormOk" styleClass="button"
        value="#{messages['command.create']}" action="#{importActions.createImportSet}"
        onclick="processInProgress()"
        data="#{facesContext.maximumSeverity.ordinal ge 2}"
        oncomplete="if (data) { hideWaiter() } else { processFinished() };"
        reRender="filterFormPanel, filterResultTable, selectionView, importset_form, folderSearchResult" />

      <a4j:commandButton styleClass="button"
        value="#{messages['command.cancel']}" action="#{importActions.cancel}"
        oncomplete="processFinished()"
        reRender="importset_form, fileUploadForm"
        immediate="true"/>
    </p>
  </a4j:form>
  </a4j:outputPanel>
  </a4j:region>
</div>
