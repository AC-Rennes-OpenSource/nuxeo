<div xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:a4j="http://richfaces.org/a4j"
  xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:nxh="http://nuxeo.org/nxweb/html"
  xmlns:nxd="http://nuxeo.org/nxweb/document"
  xmlns:rich="http://richfaces.org/rich">

  <rich:dataGrid
    id="dataTable"
    value="#{documents.rows}"
    var="row"  
    columns="4"
    rendered="#{documents.rowCount > 0}">
      
      <rich:panel><div class="popupTarget" docRef="#{row.data.ref}">
        <h:panelGrid>
          <a4j:commandLink id="imageLink" action="#{documentActions.setCurrentSelection(row.data)}" reRender="dataTable, selectionView">
            <nxh:graphicImage id="theImage"
              url="#{nxd:fileUrl('downloadPicture', row.data, 'Medium:content', row.data.dublincore.modified)}?conversationId=#{conversation.id}"
              style="max-height: 80px;"
              rendered="#{row.data.hasSchema('picture')}"/>
            <nxh:graphicImage value="/img/file_preview.png"
              style="max-height: 80px;"
              rendered="#{!row.data.hasSchema('picture')}"/> 
          </a4j:commandLink>
          <h:panelGroup>           
            <h:selectBooleanCheckbox
              value="#{row.selected}"
              onclick="selectDataTableRow('#{row.data.ref}', '#{providerName}', this)">
            </h:selectBooleanCheckbox>
            <span id="title_#{row.data.ref}" class="#{nxu:test(documentActions.currentSelection == row.data, 'selected', '')}">
              <a4j:commandLink id="titleLink" action="#{documentActions.setCurrentSelection(row.data)}" reRender="dataTable, selectionView">
                <nxh:outputText value="#{nxd:titleOrId(row.data)}"
                  title="#{row.data.dc.description}"
                  rendered="#{!empty row.data.dc.description}"/>
                <nxh:outputText value="#{nxd:titleOrId(row.data)}"
                  rendered="#{empty row.data.dc.description}"/>
              </a4j:commandLink>
            </span>
          </h:panelGroup>
          <h:panelGroup>  
            <h:outputText value="#{messages['label.content.thumbnail.by']} " /> 
	    <h:outputText value="#{nxu:userFullName(row.data.dam_common.author)}" />
          </h:panelGroup>
          <h:panelGroup>
            <h:outputText value="#{messages['label.content.thumbnail.creation']} " />
            <h:outputText value="#{row.data.dam_common.authoringDate}">
              <f:convertDateTime pattern="#{nxu:basicDateFormater()}"
                timeZone="#{timeZone}" />
            </h:outputText>
          </h:panelGroup>        
          
          <h:panelGroup>
            <h:outputText value="#{messages['label.content.thumbnail.size']} " /> 
            <h:outputText value="#{row.data.picture.views[1].content.length}" rendered="#{row.data.hasSchema('picture') and !empty row.data.picture.views}" />
            <h:outputText value="#{row.data.file.content.length}" rendered="#{row.data.hasSchema('file')}" />
          </h:panelGroup>                  
        </h:panelGrid>
          
      </div></rich:panel>

  </rich:dataGrid>

</div>