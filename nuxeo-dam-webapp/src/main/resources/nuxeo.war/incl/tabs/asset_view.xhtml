<div xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:a4j="http://richfaces.org/a4j"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:nxh="http://nuxeo.org/nxweb/html"
  xmlns:nxl="http://nuxeo.org/nxforms/layout"
  xmlns:nxd="http://nuxeo.org/nxweb/document">

  <h:form id="assetView">
    <nxu:methodResult name="currentSelection" value="#{documentActions.getCurrentSelection()}"> 
      <iframe src="#{documentActions.previewURL}" frameborder="0" height="512px" width="512px" scrolling="auto" id="preview-frame">
      </iframe>
      <div align="center" class="selected">
        <h4>
          <h:outputText value="#{currentSelection.picture.views[1].filename}" rendered="#{currentSelection.type eq 'Picture' and !empty currentSelection.picture.views}" />
          <h:outputText value="#{currentSelection.file.filename}" rendered="#{currentSelection.type eq 'File'}" />
        </h4>
      </div>
    
      <nxu:methodResult name="displayMode" value="#{documentActions.getDisplayMode()}"> 
        <nxl:layout name="heading" mode="#{displayMode}" value="#{currentSelection}" />
        <nxl:layout name="damc" mode="#{displayMode}" value="#{currentSelection}" />
        <nxl:layout name="dublincore" mode="#{displayMode}" value="#{currentSelection}" />
        
        <h:panelGrid class="dataOutput" columnClasses="labelColumn, fieldColumn" columns="2">
          <h:outputText value="#{messages['label.content.size']}" />
          <h:panelGroup>
            <h:outputText value="#{currentSelection.picture.views[1].content.length}" rendered="#{currentSelection.type eq 'Picture' and !empty currentSelection.picture.views}" />
            <h:outputText value="#{currentSelection.file.content.length}" rendered="#{currentSelection.type eq 'File'}" />
          </h:panelGroup>
        </h:panelGrid>
        <h:panelGrid class="dataOutput" columnClasses="labelColumn, fieldColumn" columns="2" rendered="#{currentSelection.type eq 'Picture' and !empty currentSelection.picture.views}">
          <h:outputText value="#{messages['label.content.height']}" />
          <h:outputText value="#{currentSelection.picture.views[1].height}" />
          
          <h:outputText value="#{messages['label.content.width']}" />
          <h:outputText value="#{currentSelection.picture.views[1].width}" />
        </h:panelGrid>
        
        <p>
          <span>
            <a4j:commandLink id="saveBtn" action="#{documentActions.updateCurrentSelection}" rendered="#{displayMode == 'edit'}" reRender="assetView, documentsList" >
              <h:outputText value="#{messages['command.save']}" />
            </a4j:commandLink>
          </span>
          <span>
            <a4j:commandLink action="#{documentActions.toggleDisplayMode}" immediate="true" reRender="assetView" >
              <h:outputText value="#{messages['command.cancel']}" rendered="#{displayMode == 'edit'}" />
              <h:outputText value="#{messages['command.edit']}" rendered="#{displayMode == 'view'}" />
            </a4j:commandLink>
          </span>
        </p>
      </nxu:methodResult>
    </nxu:methodResult>
  </h:form>

</div>