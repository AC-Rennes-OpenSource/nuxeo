<div xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:a4j="http://richfaces.org/a4j"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:nxh="http://nuxeo.org/nxweb/html"
  xmlns:nxl="http://nuxeo.org/nxforms/layout"
  xmlns:nxd="http://nuxeo.org/nxweb/document">
  
  <iframe class="previewIframe" src="#{documentActions.previewURL}" frameborder="0" height="350px" width="512px" scrolling="auto" id="preview-frame">
  </iframe>

  <h:form id="assetView">
    <nxu:methodResult name="currentSelection" value="#{documentActions.getCurrentSelection()}"> 
      <div class="documentPreviewTitle">
        <h4>
          <h:outputText value="#{currentSelection.picture.views[1].filename}" rendered="#{currentSelection.type eq 'Picture' and !empty currentSelection.picture.views}" />
          <h:outputText value="#{currentSelection.file.filename}" rendered="#{currentSelection.type eq 'File'}" />
        </h4>
      </div>
      
      
      <div class="foldableBox">
      	<nxu:methodResult name="displayMode" value="#{documentActions.getDisplayMode()}">
        <div class="foldableBoxTitleBox">
        <h3 class="unfolded">
          <a href="#nogo" onclick="return toggleBox(this)">
            <h:outputText value="#{messages['label.header.info.main.data']}" />
          </a>
        </h3>
        <div class="dataBlockActions">
              <span>
                <a4j:commandLink styleClass="button" action="#{documentActions.updateCurrentSelection}" rendered="#{displayMode == 'edit'}" reRender="assetView, documentsList" >
                  <h:outputText value="#{messages['command.save']}" />
                </a4j:commandLink>
              </span>
              <span>
                <a4j:commandLink styleClass="button" action="#{documentActions.toggleDisplayMode}" immediate="true" reRender="assetView" >
                  <h:outputText value="#{messages['command.cancel']}" rendered="#{displayMode == 'edit'}" />
                  <h:outputText value="#{messages['command.edit']}" rendered="#{displayMode == 'view'}" />
                </a4j:commandLink>
              </span>
          </div>
          <div style="clear:both;"></div>
        </div>
        <div class="boxBody"> 
            <nxl:layout name="heading" mode="#{displayMode}" value="#{currentSelection}" />
            <nxl:layout name="damc" mode="#{displayMode}" value="#{currentSelection}" />
            <nxl:layout name="dublincore" mode="#{displayMode}" value="#{currentSelection}" />
            
            <h:panelGrid class="dataOutput" columnClasses="labelColumn, fieldColumn" columns="2">
              <h:outputText value="#{messages['label.content.size']}" />
              <h:panelGroup>
                <h:outputText value="#{currentSelection.picture.views[1].content.length}" rendered="#{currentSelection.type eq 'Picture' and !empty currentSelection.picture.views}" />
                <h:outputText value="#{currentSelection.file.content.length}" rendered="#{currentSelection.type eq 'File'}" />
              </h:panelGroup>
            </h:panelGrid>
            <h:panelGrid class="dataOutput" columnClasses="labelColumn, fieldColumn" columns="2" rendered="#{currentSelection.type eq 'Picture' and !empty currentSelection.picture.views}">
              <h:outputText value="#{messages['label.content.height']}" />
              <h:outputText value="#{currentSelection.picture.views[1].height}" />
              
              <h:outputText value="#{messages['label.content.width']}" />
              <h:outputText value="#{currentSelection.picture.views[1].width}" />
            </h:panelGrid>
        </div>
        </nxu:methodResult>
      </div>
    </nxu:methodResult>
    <div class="foldableBox">
      <div class="foldableBoxTitleBox">
	    <h3 class="folded">
	      <a href="#nogo" onclick="return toggleBox(this)">
	        <h:outputText value="#{messages['label.header.info.iptc']}"/>
	      </a>
	    </h3>
	    <div style="clear:both;"></div>
	  </div>
      <div class="boxBody" style="display:none">
        <h:outputText value="#{messages['label.header.info.iptc']}"/>
      </div>
    </div>
    <div class="foldableBox">
      <div class="foldableBoxTitleBox">
	    <h3 class="folded">
	      <a href="#nogo" onclick="return toggleBox(this)">
	        <h:outputText value="#{messages['label.header.info.xmp']}"/>
	      </a>
	    </h3>
	    <div style="clear:both;"></div>
      </div>
      <div class="boxBody" style="display:none">
        <h:outputText value="#{messages['label.header.info.xmp']}"/>
      </div>
    </div>
    <div class="foldableBox">
      <div class="foldableBoxTitleBox">
        <h3 class="folded">
          <a href="#nogo" onclick="return toggleBox(this)">
            <h:outputText value="#{messages['label.header.info.exif']}"/>
          </a>
        </h3>
        <div style="clear:both;"></div>
      </div>
      <div class="boxBody" style="display: none">
        <h:outputText value="#{messages['label.header.info.exif']}"/>
      </div>
    </div>
  </h:form>

</div>